üü£ N≈ìud : Http Request Post Slides


üìå R√¥le


Ce n≈ìud est responsable de l‚Äôinjection dynamique des donn√©es et des graphiques dans le mod√®le Google Slides copi√©.
Il utilise l‚ÄôAPI Google Slides (presentations.batchUpdate) pour :

 1- Remplacer les images des espaces r√©serv√©s (progress bars, graphiques par session, radar global).

 2- Remplacer le texte des placeholders (EMAIL), (DATE), (S1_SUB1_BILAN), etc. par les vraies valeurs calcul√©es dans les n≈ìuds pr√©c√©dents.

C‚Äôest l‚Äô√©tape cl√© qui transforme le mod√®le g√©n√©rique en un rapport personnalis√© pour le candidat.





‚öôÔ∏è Param√®tres principaux


M√©thode HTTP : POST

URL :

--------------------------------------------------------------------------------------------------------
https://slides.googleapis.com/v1/presentations/{{ $('Copy File Slide Model').item.json.id }}:batchUpdate
--------------------------------------------------------------------------------------------------------


üëâ On cible bien la pr√©sentation nouvellement copi√©e depuis le mod√®le.

 . Authentification : OAuth2 via Google Slides API.

 . Body Content Type : JSON.

 . Payload : objet { "requests": [...] } contenant toutes les instructions (remplacement images + textes).




üõ†Ô∏è Logique des requ√™tes


1. üîÑ Remplacement des images dynamiques

Chaque placeholder image du mod√®le (ex. S1_BAR_IMG, S2_GRAPH_IMG, RADAR_IMG) est remplac√© 
par un graphique g√©n√©r√© via QuickChart (n≈ìud Graph URL create).
Exemple :

##################################################################
{
  "replaceImage": {
    "imageObjectId": "{{ $json.images.S1_BAR_IMG.objectId }}",
    "imageReplaceMethod": "CENTER_INSIDE",
    "url": "{{ $('Graph URL create').item.json.S1_PROGRESS_IMG }}"
  }                     ## Exemple (Not Use) ##
}
###################################################################

 . imageObjectId : identifiant de l‚Äôobjet image dans le slide (trouv√© via Extract images from slides).

 . url : l‚ÄôURL QuickChart g√©n√©r√©e.

 . imageReplaceMethod : "CENTER_INSIDE" ‚Üí l‚Äôimage est ins√©r√©e sans d√©formation, centr√©e dans le cadre.



üëâ Cela couvre :

 . Les progress bars par session (S1_BAR_IMG1, S2_BAR_IMG1, ‚Ä¶).

 . Les barres comparatives (S1_GRAPH_IMG, S2_GRAPH_IMG, ‚Ä¶).

 . Le radar global (RADAR_IMG).




2. üìù Remplacement des placeholders texte

Tous les placeholders du mod√®le (DATE), (EMAIL), (S1_SUB1_BILAN), etc. sont remplac√©s par les valeurs calcul√©es dans le n≈ìud placeholders.
Exemple :

#################################################################################
{
  "replaceAllText": {
    "containsText": { "text": "(S1_SUB1_BILAN)", "matchCase": true },
    "replaceText": "{{ $('placeholders').item.json.placeholders.S1_SUB1_BILAN }}"
  }                           ## Exemple (Not Use) ##
}
#################################################################################

üëâ Le mapping couvre :

 . Les infos globales : (DATE), (EMAIL), (GLOBAL_PCT).

 . Les titres et scores par session : (S1_TITLE), (S2_PCT), etc.

 . Les d√©tails par sous-th√®me : (S1_SUB2_TITLE), (S1_SUB2_PCT), (S1_SUB2_STARS), (S1_SUB2_BILAN), etc.





‚úÖ Sortie

 . La pr√©sentation Google Slides est mise √† jour avec :

    . Les graphiques personnalis√©s (progress bars, comparatifs, radar).

    . Les valeurs textuelles (scores, pourcentages, √©toiles, bilans).

 . Le rapport devient donc un document enti√®rement personnalis√© pr√™t √† √™tre export√© en PDF.