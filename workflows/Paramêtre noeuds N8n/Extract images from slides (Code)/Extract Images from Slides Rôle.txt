üü¢ Extract Images from Slides

üéØ R√¥le


Ce n≈ìud sert √† identifier les images ‚Äúmarqueurs‚Äù dans la pr√©sentation Google Slides copi√©e (mod√®le du rapport).
Il va parcourir toutes les diapositives et extraire les √©l√©ments d‚Äôimage dont le titre correspond √† 
une cl√© sp√©cifique (ex : S1_GRAPH_IMG.png).
Ces cl√©s servent ensuite √† remplacer les images par les graphiques g√©n√©r√©s (QuickChart).





‚öôÔ∏è Configuration

 . Mode : Run Once for All Items

 . Language : JavaScript


üìù Script utilis√©

-------------------------------------------------------------
// Entr√©e : sortie brute du HTTP Request Get Slides
const slides = $json.slides || [];

// Dictionnaire final
const images = {};

// Parcours des slides et des objets
for (const slide of slides) {
  for (const el of (slide.pageElements || [])) {
    // On garde uniquement ceux dont le titre finit par .png
    if (el.title && el.title.endsWith(".png")) {
      // Ex : titre "S1_GRAPH_IMG.png" ‚Üí cl√© "S1_GRAPH_IMG"
      const key = el.title.replace(".png", "");
      images[key] = {
        objectId: el.objectId,
        altText: el.title
      };
    }
  }
}

// Sortie unique
return [{
  json: {
    images
  }
}];
---------------------------------------------------------------




üì§ Donn√©es en sortie


Un dictionnaire images :

 . cl√© : nom du placeholder image (S1_GRAPH_IMG, RADAR_IMG, etc.)

 . objectId : identifiant unique de l‚Äôobjet dans Google Slides (n√©cessaire pour l‚ÄôAPI).

 . altText : texte alternatif (= le titre de l‚Äôobjet, ex : S1_GRAPH_IMG.png).




üëâ Exemple de sortie :

###################################
{
  "images": {
    "S1_GRAPH_IMG": {
      "objectId": "g37e4a4fb7e4_5",
      "altText": "S1_GRAPH_IMG.png"
    },
    "S2_GRAPH_IMG": {
      "objectId": "g37e6cc39b4e3_2",
      "altText": "S2_GRAPH_IMG.png"
    },
    "RADAR_IMG": {
      "objectId": "g37e6cc39b4e3_0",
      "altText": "RADAR_IMG.png"
    }
  }       ## Exemple (Not Use) ##
}
####################################




‚úÖ Points cl√©s

 . Seules les images nomm√©es avec un titre .png dans le mod√®le Slides sont retenues.

 . Les cl√©s (S1_GRAPH_IMG, S1_PROGRESS_IMG, etc.) sont utilis√©es plus tard pour injecter les bons graphiques.

 . L‚ÄôobjectId est essentiel : c‚Äôest ce qui permet √† l‚ÄôAPI Google Slides de cibler et remplacer l‚Äôimage.