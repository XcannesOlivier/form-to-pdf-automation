ðŸŸ¢ Build_report

RÃ´le


Ce nÅ“ud est un nÅ“ud Code (JavaScript) en mode Run Once for All Items.
Il construit le rapport final Ã  partir des scores calculÃ©s par AnalyseS.

Ce rapport inclut :

 . Score global avec Ã©toiles â˜…

 . Bilan global gÃ©nÃ©rique

 . RÃ©sultats par sessions (1 Ã  4)

 . RÃ©sultats par sous-thÃ¨mes (3 par session) avec textes de bilan adaptÃ©s au niveau




Fonctionnement du script


1) Helpers

------------------------------------------------------------------
const pct   = (s, m) => (m ? +(100 * s / m).toFixed(1) : 0);
const stars = (p) => p < 40 ? "â˜…â˜†â˜†" : p < 70 ? "â˜…â˜…â˜†" : "â˜…â˜…â˜…";
------------------------------------------------------------------

 . pct â†’ calcule un pourcentage.

 . stars â†’ attribue un nombre dâ€™Ã©toiles en fonction du score.


-------------------------------------------------------------------------
const genericBilan = (p) =>
  p < 40 ? "Niveau Ã  consolider : reprenez les bases essentielles."
: p < 70 ? "Bon socle : poursuivez des exercices ciblÃ©s pour progresser."
         : "TrÃ¨s bonne maÃ®trise : continuez avec des cas plus avancÃ©s.";
-------------------------------------------------------------------------

 . Texte gÃ©nÃ©rique par dÃ©faut si aucun bilan spÃ©cifique nâ€™existe.


--------------------------------------------------------------------------------
const levelFromPct = (p) =>
  p < 40 ? "DÃ©butant" : p < 60 ? "En progrÃ¨s" : p < 80 ? "CompÃ©tent" : "Expert";
const levelKey = (p) =>
  p < 40 ? "debutant" : p < 60 ? "en_progres" : p < 80 ? "competent" : "expert";
--------------------------------------------------------------------------------

 . Permet de transformer un % en libellÃ© de niveau ou en clÃ© (utile pour bilans spÃ©cifiques).



2) Bilans spÃ©cifiques

---------------------------------------------------------------------------------
const BILANS = {
  "1:1": { debutant: "...", en_progres: "...", competent: "...", expert: "..." },
  "1:2": { ... },
  ...
};
---------------------------------------------------------------------------------

 . Chaque clÃ© = ${sessionId}:${partId} (ex. "2:3" = session 2, sous-thÃ¨me 3).

 . Chaque niveau (dÃ©butant, en_progres, compÃ©tent, expert) possÃ¨de un texte adaptÃ©.

 . Exemple :

    . Session 1 / Sous-thÃ¨me 1 (Navigation & Internet)

       . DÃ©butant â†’ Â« Bases fragiles : comprendre navigateur, recherche, diffÃ©rence email/URL. Â»

       . Expert â†’ Â« Bonne maÃ®trise : recherche efficace, distinction email/web. Poursuis avec favoris/onglets. Â»




3) Mapping des questions â†’ sous-thÃ¨mes

----------------------------------------------------------------------------------------------
const EXPLICIT_MAP = {
  "1": { "1": ["q1","q2","q4"], "2": ["q5","q6","q8"], "3": ["q3","q7","q9","q10"] },
  "2": { "1": ["q11","q12","q13","q14","q16"], "2": ["q15","q17","q18"], "3": ["q19","q20"] },
  ...
};
----------------------------------------------------------------------------------------------

 . Chaque session est dÃ©coupÃ©e en 3 sous-thÃ¨mes avec une liste explicite de questions.

 . Permet de calculer des scores partiels et dâ€™associer un bilan ciblÃ©.



4) Construction du rapport

---------------------------------------------
const report = {
  horodateur: a.horodateur,
  email: a["email"] || "", 
  global: {
    score: a.total_score,
    max:   a.total_max,
    pct:   a.percent,
    level: a.level || levelFromPct(a.percent),
    stars: stars(a.percent),
    bilan: genericBilan(a.percent),
  },
  sessions: [],
};
----------------------------------------------

 . Ajoute score global, niveau, Ã©toiles et bilan gÃ©nÃ©rique.



5) Sessions et sous-thÃ¨mes

Pour chaque session (1 Ã  4) :

 . RÃ©cupÃ¨re les sous-thÃ¨mes et calcule leurs scores.

 . Associe un bilan spÃ©cifique selon le niveau (si dÃ©fini dans BILANS).

 . Ajoute tout au rapport.


Exemple de sortie :

-----------------------------------------------------------------------------
{
  "global": {
    "score": 70.5,
    "max": 119.5,
    "pct": 59,
    "level": "En progrÃ¨s",
    "stars": "â˜…â˜…â˜†",
    "bilan": "Bon socle : poursuivez des exercices ciblÃ©s pour progresser."
  },
  "sessions": [
    {
      "id": "1",
      "label": "Session 1",
      "total_score": 14.5,
      "total_max": 26.5,
      "total_pct": 54.7,
      "level": "En progrÃ¨s",
      "stars": "â˜…â˜…â˜†",
      "bilan": "Bon socle : poursuivez des exercices ciblÃ©s pour progresser.",
      "subthemes": [
        {
          "id": "1",
          "label": "Navigation & Internet",
          "pct": 50,
          "level": "DÃ©butant",
          "stars": "â˜…â˜†â˜†",
          "bilan": "Bases fragiles : comprendre navigateur, recherche, diffÃ©rence email/URL."
        },
        ...
      ]
    }
  ]
}
----------------------------------------------------------------------------------------------



Points clÃ©s

 . âœ… GÃ©nÃ¨re un rapport hiÃ©rarchisÃ© (global â†’ sessions â†’ sous-thÃ¨mes).

 . âœ… Combine des bilans gÃ©nÃ©riques et des bilans personnalisÃ©s selon le niveau.

 . âœ… Produit des Ã©toiles â˜… pour faciliter la lecture dans le PDF/Slides.

 . âš ï¸ DÃ©pend de la cohÃ©rence du EXPLICIT_MAP et des clÃ©s dÃ©finies dans BILANS.